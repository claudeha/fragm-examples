#donotrun
// (c) 2018-2020 Claude Heiland-Allen
// SPDX-License-Identifier: GPL-3.0-or-later

// linear XYZ to linear RGB
// <https://en.wikipedia.org/wiki/SRGB#The_forward_transformation_(CIE_XYZ_to_sRGB)>
vec3 xyz2rgb(in vec3 l)
{
  const vec3 whitePoint = vec3(0.9505, 1.0000, 1.0890);
  const mat3 matrix = mat3
    (  3.2406, -1.5372, -0.4986
    , -0.9689,  1.8758,  0.0415
    ,  0.0557, -0.2040,  1.0570
    );
  return (whitePoint * l) * matrix;
}

// linear RGB to linear XYZ
// <https://en.wikipedia.org/wiki/SRGB#The_reverse_transformation>
vec3 rgb2xyz(in vec3 l)
{
  const vec3 whitePoint = vec3(0.9505, 1.0000, 1.0890);
  const mat3 matrix = mat3
    ( 0.4124, 0.3576, 0.1805
    , 0.2126, 0.7152, 0.0722
    , 0.0193, 0.1192, 0.9505
    );
  return (l * matrix) / whitePoint;
}

// CIE standard observer
// <https://en.wikipedia.org/wiki/CIE_1931_color_space#CIE_standard_observer>
vec3 observer(in float wavelength)
{
const int wavelength_min = 390;
const int wavelength_max = 830;
#define wavelength_count 441
const vec3 tristimulus_curve[wavelength_count] = vec3[wavelength_count]
  ( vec3(3.769647e-3, 4.146161e-4, 1.847260e-2)
  , vec3(4.532416e-3, 5.028333e-4, 2.221101e-2)
  , vec3(5.446553e-3, 6.084991e-4, 2.669819e-2)
  , vec3(6.538868e-3, 7.344436e-4, 3.206937e-2)
  , vec3(7.839699e-3, 8.837389e-4, 3.847832e-2)
  , vec3(9.382967e-3, 1.059646e-3, 4.609784e-2)
  , vec3(1.120608e-2, 1.265532e-3, 5.511953e-2)
  , vec3(1.334965e-2, 1.504753e-3, 6.575257e-2)
  , vec3(1.585690e-2, 1.780493e-3, 7.822113e-2)
  , vec3(1.877286e-2, 2.095572e-3, 9.276013e-2)
  , vec3(2.214302e-2, 2.452194e-3, 1.096090e-1)
  , vec3(2.601285e-2, 2.852216e-3, 1.290077e-1)
  , vec3(3.043036e-2, 3.299115e-3, 1.512047e-1)
  , vec3(3.544325e-2, 3.797466e-3, 1.764441e-1)
  , vec3(4.109640e-2, 4.352768e-3, 2.049517e-1)
  , vec3(4.742986e-2, 4.971717e-3, 2.369246e-1)
  , vec3(5.447394e-2, 5.661014e-3, 2.725123e-1)
  , vec3(6.223612e-2, 6.421615e-3, 3.117820e-1)
  , vec3(7.070048e-2, 7.250312e-3, 3.547064e-1)
  , vec3(7.982513e-2, 8.140173e-3, 4.011473e-1)
  , vec3(8.953803e-2, 9.079860e-3, 4.508369e-1)
  , vec3(9.974848e-2, 1.005608e-2, 5.034164e-1)
  , vec3(1.104019e-1, 1.106456e-2, 5.586361e-1)
  , vec3(1.214566e-1, 1.210522e-2, 6.162734e-1)
  , vec3(1.328741e-1, 1.318014e-2, 6.760982e-1)
  , vec3(1.446214e-1, 1.429377e-2, 7.378822e-1)
  , vec3(1.566468e-1, 1.545004e-2, 8.013019e-1)
  , vec3(1.687901e-1, 1.664093e-2, 8.655573e-1)
  , vec3(1.808328e-1, 1.785302e-2, 9.295791e-1)
  , vec3(1.925216e-1, 1.907018e-2, 9.921293e-1)
  , vec3(2.035729e-1, 2.027369e-2, 1.051821)
  , vec3(2.137531e-1, 2.144805e-2, 1.107509)
  , vec3(2.231348e-1, 2.260041e-2, 1.159527)
  , vec3(2.319245e-1, 2.374789e-2, 1.208869)
  , vec3(2.403892e-1, 2.491247e-2, 1.256834)
  , vec3(2.488523e-1, 2.612106e-2, 1.305008)
  , vec3(2.575896e-1, 2.739923e-2, 1.354758)
  , vec3(2.664991e-1, 2.874993e-2, 1.405594)
  , vec3(2.753532e-1, 3.016909e-2, 1.456414)
  , vec3(2.838921e-1, 3.165145e-2, 1.505960)
  , vec3(2.918246e-1, 3.319038e-2, 1.552826)
  , vec3(2.989200e-1, 3.477912e-2, 1.595902)
  , vec3(3.052993e-1, 3.641495e-2, 1.635768)
  , vec3(3.112031e-1, 3.809569e-2, 1.673573)
  , vec3(3.169047e-1, 3.981843e-2, 1.710604)
  , vec3(3.227087e-1, 4.157940e-2, 1.748280)
  , vec3(3.288194e-1, 4.337098e-2, 1.787504)
  , vec3(3.349242e-1, 4.517180e-2, 1.826609)
  , vec3(3.405452e-1, 4.695420e-2, 1.863108)
  , vec3(3.451688e-1, 4.868718e-2, 1.894332)
  , vec3(3.482554e-1, 5.033657e-2, 1.917479)
  , vec3(3.494153e-1, 5.187611e-2, 1.930529)
  , vec3(3.489075e-1, 5.332218e-2, 1.934819)
  , vec3(3.471746e-1, 5.470603e-2, 1.932650)
  , vec3(3.446705e-1, 5.606335e-2, 1.926395)
  , vec3(3.418483e-1, 5.743393e-2, 1.918437)
  , vec3(3.390240e-1, 5.885107e-2, 1.910430)
  , vec3(3.359926e-1, 6.030809e-2, 1.901224)
  , vec3(3.324276e-1, 6.178644e-2, 1.889000)
  , vec3(3.280157e-1, 6.326570e-2, 1.871996)
  , vec3(3.224637e-1, 6.472352e-2, 1.848545)
  , vec3(3.156225e-1, 6.614749e-2, 1.817792)
  , vec3(3.078201e-1, 6.757256e-2, 1.781627)
  , vec3(2.994771e-1, 6.904928e-2, 1.742514)
  , vec3(2.909776e-1, 7.063280e-2, 1.702749)
  , vec3(2.826646e-1, 7.238339e-2, 1.664439)
  , vec3(2.747962e-1, 7.435960e-2, 1.629207)
  , vec3(2.674312e-1, 7.659383e-2, 1.597360)
  , vec3(2.605847e-1, 7.911436e-2, 1.568896)
  , vec3(2.542749e-1, 8.195345e-2, 1.543823)
  , vec3(2.485254e-1, 8.514816e-2, 1.522157)
  , vec3(2.433039e-1, 8.872657e-2, 1.503611)
  , vec3(2.383414e-1, 9.266008e-2, 1.486673)
  , vec3(2.333253e-1, 9.689723e-2, 1.469595)
  , vec3(2.279619e-1, 1.013746e-1, 1.450709)
  , vec3(2.219781e-1, 1.060145e-1, 1.428440)
  , vec3(2.151735e-1, 1.107377e-1, 1.401587)
  , vec3(2.075619e-1, 1.155111e-1, 1.370094)
  , vec3(1.992183e-1, 1.203122e-1, 1.334220)
  , vec3(1.902290e-1, 1.251161e-1, 1.294275)
  , vec3(1.806905e-1, 1.298957e-1, 1.250610)
  , vec3(1.707154e-1, 1.346299e-1, 1.203696)
  , vec3(1.604471e-1, 1.393309e-1, 1.154316)
  , vec3(1.500244e-1, 1.440235e-1, 1.103284)
  , vec3(1.395705e-1, 1.487372e-1, 1.051347)
  , vec3(1.291920e-1, 1.535066e-1, 9.991789e-1)
  , vec3(1.189859e-1, 1.583644e-1, 9.473958e-1)
  , vec3(1.090615e-1, 1.633199e-1, 8.966222e-1)
  , vec3(9.951424e-2, 1.683761e-1, 8.473981e-1)
  , vec3(9.041850e-2, 1.735365e-1, 8.001576e-1)
  , vec3(8.182895e-2, 1.788048e-1, 7.552379e-1)
  , vec3(7.376817e-2, 1.841819e-1, 7.127879e-1)
  , vec3(6.619477e-2, 1.896559e-1, 6.725198e-1)
  , vec3(5.906380e-2, 1.952101e-1, 6.340976e-1)
  , vec3(5.234242e-2, 2.008259e-1, 5.972433e-1)
  , vec3(4.600865e-2, 2.064828e-1, 5.617313e-1)
  , vec3(4.006154e-2, 2.121826e-1, 5.274921e-1)
  , vec3(3.454373e-2, 2.180279e-1, 4.948809e-1)
  , vec3(2.949091e-2, 2.241586e-1, 4.642586e-1)
  , vec3(2.492140e-2, 2.307302e-1, 4.358841e-1)
  , vec3(2.083981e-2, 2.379160e-1, 4.099313e-1)
  , vec3(1.723591e-2, 2.458706e-1, 3.864261e-1)
  , vec3(1.407924e-2, 2.546023e-1, 3.650566e-1)
  , vec3(1.134516e-2, 2.640760e-1, 3.454812e-1)
  , vec3(9.019658e-3, 2.742490e-1, 3.274095e-1)
  , vec3(7.097731e-3, 2.850680e-1, 3.105939e-1)
  , vec3(5.571145e-3, 2.964837e-1, 2.948102e-1)
  , vec3(4.394566e-3, 3.085010e-1, 2.798194e-1)
  , vec3(3.516303e-3, 3.211393e-1, 2.654100e-1)
  , vec3(2.887638e-3, 3.344175e-1, 2.514084e-1)
  , vec3(2.461588e-3, 3.483536e-1, 2.376753e-1)
  , vec3(2.206348e-3, 3.629601e-1, 2.241211e-1)
  , vec3(2.149559e-3, 3.782275e-1, 2.107484e-1)
  , vec3(2.337091e-3, 3.941359e-1, 1.975839e-1)
  , vec3(2.818931e-3, 4.106582e-1, 1.846574e-1)
  , vec3(3.649178e-3, 4.277595e-1, 1.720018e-1)
  , vec3(4.891359e-3, 4.453993e-1, 1.596918e-1)
  , vec3(6.629364e-3, 4.635396e-1, 1.479415e-1)
  , vec3(8.942902e-3, 4.821376e-1, 1.369428e-1)
  , vec3(1.190224e-2, 5.011430e-1, 1.268279e-1)
  , vec3(1.556989e-2, 5.204972e-1, 1.176796e-1)
  , vec3(1.997668e-2, 5.401387e-1, 1.094970e-1)
  , vec3(2.504698e-2, 5.600208e-1, 1.020943e-1)
  , vec3(3.067530e-2, 5.800972e-1, 9.527993e-2)
  , vec3(3.674999e-2, 6.003172e-1, 8.890075e-2)
  , vec3(4.315171e-2, 6.206256e-1, 8.283548e-2)
  , vec3(4.978584e-2, 6.409398e-1, 7.700982e-2)
  , vec3(5.668554e-2, 6.610772e-1, 7.144001e-2)
  , vec3(6.391651e-2, 6.808134e-1, 6.615436e-2)
  , vec3(7.154352e-2, 6.999044e-1, 6.117199e-2)
  , vec3(7.962917e-2, 7.180890e-1, 5.650407e-2)
  , vec3(8.821473e-2, 7.351593e-1, 5.215121e-2)
  , vec3(9.726978e-2, 7.511821e-1, 4.809566e-2)
  , vec3(1.067504e-1, 7.663143e-1, 4.431720e-2)
  , vec3(1.166192e-1, 7.807352e-1, 4.079734e-2)
  , vec3(1.268468e-1, 7.946448e-1, 3.751912e-2)
  , vec3(1.374060e-1, 8.082074e-1, 3.446846e-2)
  , vec3(1.482471e-1, 8.213817e-1, 3.163764e-2)
  , vec3(1.593076e-1, 8.340701e-1, 2.901901e-2)
  , vec3(1.705181e-1, 8.461711e-1, 2.660364e-2)
  , vec3(1.818026e-1, 8.575799e-1, 2.438164e-2)
  , vec3(1.931090e-1, 8.682408e-1, 2.234097e-2)
  , vec3(2.045085e-1, 8.783061e-1, 2.046415e-2)
  , vec3(2.161166e-1, 8.879907e-1, 1.873456e-2)
  , vec3(2.280650e-1, 8.975211e-1, 1.713788e-2)
  , vec3(2.405015e-1, 9.071347e-1, 1.566174e-2)
  , vec3(2.535441e-1, 9.169947e-1, 1.429644e-2)
  , vec3(2.671300e-1, 9.269295e-1, 1.303702e-2)
  , vec3(2.811351e-1, 9.366731e-1, 1.187897e-2)
  , vec3(2.954164e-1, 9.459482e-1, 1.081725e-2)
  , vec3(3.098117e-1, 9.544675e-1, 9.846470e-3)
  , vec3(3.241678e-1, 9.619834e-1, 8.960687e-3)
  , vec3(3.384319e-1, 9.684390e-1, 8.152811e-3)
  , vec3(3.525786e-1, 9.738289e-1, 7.416025e-3)
  , vec3(3.665839e-1, 9.781519e-1, 6.744115e-3)
  , vec3(3.804244e-1, 9.814106e-1, 6.131421e-3)
  , vec3(3.940988e-1, 9.836669e-1, 5.572778e-3)
  , vec3(4.076972e-1, 9.852081e-1, 5.063463e-3)
  , vec3(4.213484e-1, 9.863813e-1, 4.599169e-3)
  , vec3(4.352003e-1, 9.875357e-1, 4.175971e-3)
  , vec3(4.494206e-1, 9.890228e-1, 3.790291e-3)
  , vec3(4.641616e-1, 9.910811e-1, 3.438952e-3)
  , vec3(4.794395e-1, 9.934913e-1, 3.119341e-3)
  , vec3(4.952180e-1, 9.959172e-1, 2.829038e-3)
  , vec3(5.114395e-1, 9.980205e-1, 2.565722e-3)
  , vec3(5.280233e-1, 9.994608e-1, 2.327186e-3)
  , vec3(5.448696e-1, 9.999930e-1, 2.111280e-3)
  , vec3(5.618898e-1, 9.997557e-1, 1.915766e-3)
  , vec3(5.790137e-1, 9.989839e-1, 1.738589e-3)
  , vec3(5.961882e-1, 9.979123e-1, 1.577920e-3)
  , vec3(6.133784e-1, 9.967737e-1, 1.432128e-3)
  , vec3(6.305897e-1, 9.957356e-1, 1.299781e-3)
  , vec3(6.479223e-1, 9.947115e-1, 1.179667e-3)
  , vec3(6.654866e-1, 9.935534e-1, 1.070694e-3)
  , vec3(6.833782e-1, 9.921156e-1, 9.718623e-4)
  , vec3(7.016774e-1, 9.902549e-1, 8.822531e-4)
  , vec3(7.204110e-1, 9.878596e-1, 8.010231e-4)
  , vec3(7.394495e-1, 9.849324e-1, 7.273884e-4)
  , vec3(7.586285e-1, 9.815036e-1, 6.606347e-4)
  , vec3(7.777885e-1, 9.776035e-1, 6.001146e-4)
  , vec3(7.967750e-1, 9.732611e-1, 5.452416e-4)
  , vec3(8.154530e-1, 9.684764e-1, 4.954847e-4)
  , vec3(8.337389e-1, 9.631369e-1, 4.503642e-4)
  , vec3(8.515493e-1, 9.571062e-1, 4.094455e-4)
  , vec3(8.687862e-1, 9.502540e-1, 3.723345e-4)
  , vec3(8.853376e-1, 9.424569e-1, 3.386739e-4)
  , vec3(9.011588e-1, 9.336897e-1, 3.081396e-4)
  , vec3(9.165278e-1, 9.242893e-1, 2.804370e-4)
  , vec3(9.318245e-1, 9.146707e-1, 2.552996e-4)
  , vec3(9.474524e-1, 9.052333e-1, 2.324859e-4)
  , vec3(9.638388e-1, 8.963613e-1, 2.117772e-4)
  , vec3(9.812596e-1, 8.883069e-1, 1.929758e-4)
  , vec3(9.992953e-1, 8.808462e-1, 1.759024e-4)
  , vec3(1.017343, 8.736445e-1, 1.603947e-4)
  , vec3(1.034790, 8.663755e-1, 1.463059e-4)
  , vec3(1.051011, 8.587203e-1, 1.335031e-4)
  , vec3(1.065522, 8.504295e-1, 1.218660e-4)
  , vec3(1.078421, 8.415047e-1, 1.112857e-4)
  , vec3(1.089944, 8.320109e-1, 1.016634e-4)
  , vec3(1.100320, 8.220154e-1, 9.291003e-5)
  , vec3(1.109767, 8.115868e-1, 8.494468e-5)
  , vec3(1.118438, 8.007874e-1, 7.769425e-5)
  , vec3(1.126266, 7.896515e-1, 7.109247e-5)
  , vec3(1.133138, 7.782053e-1, 6.507936e-5)
  , vec3(1.138952, 7.664733e-1, 5.960061e-5)
  , vec3(1.143620, 7.544785e-1, 5.460706e-5)
  , vec3(1.147095, 7.422473e-1, 5.005417e-5)
  , vec3(1.149464, 7.298229e-1, 4.590157e-5)
  , vec3(1.150838, 7.172525e-1, 4.211268e-5)
  , vec3(1.151326, 7.045818e-1, 3.865437e-5)
  , vec3(1.151033, 6.918553e-1, 3.549661e-5)
  , vec3(1.150002, 6.791009e-1, 3.261220e-5)
  , vec3(1.148061, 6.662846e-1, 2.997643e-5)
  , vec3(1.144998, 6.533595e-1, 2.756693e-5)
  , vec3(1.140622, 6.402807e-1, 2.536339e-5)
  , vec3(1.134757, 6.270066e-1, 2.334738e-5)
  , vec3(1.127298, 6.135148e-1, 2.150221e-5)
  , vec3(1.118342, 5.998494e-1, 1.981268e-5)
  , vec3(1.108033, 5.860682e-1, 1.826500e-5)
  , vec3(1.096515, 5.722261e-1, 1.684667e-5)
  , vec3(1.083928, 5.583746e-1, 1.554631e-5)
  , vec3(1.070387, 5.445535e-1, 1.435360e-5)
  , vec3(1.055934, 5.307673e-1, 1.325915e-5)
  , vec3(1.040592, 5.170130e-1, 1.225443e-5)
  , vec3(1.024385, 5.032889e-1, 1.133169e-5)
  , vec3(1.007344, 4.895950e-1, 1.048387e-5)
  , vec3(9.895268e-1, 4.759442e-1, 0.000000)
  , vec3(9.711213e-1, 4.623958e-1, 0.000000)
  , vec3(9.523257e-1, 4.490154e-1, 0.000000)
  , vec3(9.333248e-1, 4.358622e-1, 0.000000)
  , vec3(9.142877e-1, 4.229897e-1, 0.000000)
  , vec3(8.952798e-1, 4.104152e-1, 0.000000)
  , vec3(8.760157e-1, 3.980356e-1, 0.000000)
  , vec3(8.561607e-1, 3.857300e-1, 0.000000)
  , vec3(8.354235e-1, 3.733907e-1, 0.000000)
  , vec3(8.135565e-1, 3.609245e-1, 0.000000)
  , vec3(7.904565e-1, 3.482860e-1, 0.000000)
  , vec3(7.664364e-1, 3.355702e-1, 0.000000)
  , vec3(7.418777e-1, 3.228963e-1, 0.000000)
  , vec3(7.171219e-1, 3.103704e-1, 0.000000)
  , vec3(6.924717e-1, 2.980865e-1, 0.000000)
  , vec3(6.681600e-1, 2.861160e-1, 0.000000)
  , vec3(6.442697e-1, 2.744822e-1, 0.000000)
  , vec3(6.208450e-1, 2.631953e-1, 0.000000)
  , vec3(5.979243e-1, 2.522628e-1, 0.000000)
  , vec3(5.755410e-1, 2.416902e-1, 0.000000)
  , vec3(5.537296e-1, 2.314809e-1, 0.000000)
  , vec3(5.325412e-1, 2.216378e-1, 0.000000)
  , vec3(5.120218e-1, 2.121622e-1, 0.000000)
  , vec3(4.922070e-1, 2.030542e-1, 0.000000)
  , vec3(4.731224e-1, 1.943124e-1, 0.000000)
  , vec3(4.547417e-1, 1.859227e-1, 0.000000)
  , vec3(4.368719e-1, 1.778274e-1, 0.000000)
  , vec3(4.193121e-1, 1.699654e-1, 0.000000)
  , vec3(4.018980e-1, 1.622841e-1, 0.000000)
  , vec3(3.844986e-1, 1.547397e-1, 0.000000)
  , vec3(3.670592e-1, 1.473081e-1, 0.000000)
  , vec3(3.497167e-1, 1.400169e-1, 0.000000)
  , vec3(3.326305e-1, 1.329013e-1, 0.000000)
  , vec3(3.159341e-1, 1.259913e-1, 0.000000)
  , vec3(2.997374e-1, 1.193120e-1, 0.000000)
  , vec3(2.841189e-1, 1.128820e-1, 0.000000)
  , vec3(2.691053e-1, 1.067113e-1, 0.000000)
  , vec3(2.547077e-1, 1.008052e-1, 0.000000)
  , vec3(2.409319e-1, 9.516653e-2, 0.000000)
  , vec3(2.277792e-1, 8.979594e-2, 0.000000)
  , vec3(2.152431e-1, 8.469044e-2, 0.000000)
  , vec3(2.033010e-1, 7.984009e-2, 0.000000)
  , vec3(1.919276e-1, 7.523372e-2, 0.000000)
  , vec3(1.810987e-1, 7.086061e-2, 0.000000)
  , vec3(1.707914e-1, 6.671045e-2, 0.000000)
  , vec3(1.609842e-1, 6.277360e-2, 0.000000)
  , vec3(1.516577e-1, 5.904179e-2, 0.000000)
  , vec3(1.427936e-1, 5.550703e-2, 0.000000)
  , vec3(1.343737e-1, 5.216139e-2, 0.000000)
  , vec3(1.263808e-1, 4.899699e-2, 0.000000)
  , vec3(1.187979e-1, 4.600578e-2, 0.000000)
  , vec3(1.116088e-1, 4.317885e-2, 0.000000)
  , vec3(1.047975e-1, 4.050755e-2, 0.000000)
  , vec3(9.834835e-2, 3.798376e-2, 0.000000)
  , vec3(9.224597e-2, 3.559982e-2, 0.000000)
  , vec3(8.647506e-2, 3.334856e-2, 0.000000)
  , vec3(8.101986e-2, 3.122332e-2, 0.000000)
  , vec3(7.586514e-2, 2.921780e-2, 0.000000)
  , vec3(7.099633e-2, 2.732601e-2, 0.000000)
  , vec3(6.639960e-2, 2.554223e-2, 0.000000)
  , vec3(6.206225e-2, 2.386121e-2, 0.000000)
  , vec3(5.797409e-2, 2.227859e-2, 0.000000)
  , vec3(5.412533e-2, 2.079020e-2, 0.000000)
  , vec3(5.050600e-2, 1.939185e-2, 0.000000)
  , vec3(4.710606e-2, 1.807939e-2, 0.000000)
  , vec3(4.391411e-2, 1.684817e-2, 0.000000)
  , vec3(4.091411e-2, 1.569188e-2, 0.000000)
  , vec3(3.809067e-2, 1.460446e-2, 0.000000)
  , vec3(3.543034e-2, 1.358062e-2, 0.000000)
  , vec3(3.292138e-2, 1.261573e-2, 0.000000)
  , vec3(3.055672e-2, 1.170696e-2, 0.000000)
  , vec3(2.834146e-2, 1.085608e-2, 0.000000)
  , vec3(2.628033e-2, 1.006476e-2, 0.000000)
  , vec3(2.437465e-2, 9.333376e-3, 0.000000)
  , vec3(2.262306e-2, 8.661284e-3, 0.000000)
  , vec3(2.101935e-2, 8.046048e-3, 0.000000)
  , vec3(1.954647e-2, 7.481130e-3, 0.000000)
  , vec3(1.818727e-2, 6.959987e-3, 0.000000)
  , vec3(1.692727e-2, 6.477070e-3, 0.000000)
  , vec3(1.575417e-2, 6.027677e-3, 0.000000)
  , vec3(1.465854e-2, 5.608169e-3, 0.000000)
  , vec3(1.363571e-2, 5.216691e-3, 0.000000)
  , vec3(1.268205e-2, 4.851785e-3, 0.000000)
  , vec3(1.179394e-2, 4.512008e-3, 0.000000)
  , vec3(1.096778e-2, 4.195941e-3, 0.000000)
  , vec3(1.019964e-2, 3.902057e-3, 0.000000)
  , vec3(9.484317e-3, 3.628371e-3, 0.000000)
  , vec3(8.816851e-3, 3.373005e-3, 0.000000)
  , vec3(8.192921e-3, 3.134315e-3, 0.000000)
  , vec3(7.608750e-3, 2.910864e-3, 0.000000)
  , vec3(7.061391e-3, 2.701528e-3, 0.000000)
  , vec3(6.549509e-3, 2.505796e-3, 0.000000)
  , vec3(6.071970e-3, 2.323231e-3, 0.000000)
  , vec3(5.627476e-3, 2.153333e-3, 0.000000)
  , vec3(5.214608e-3, 1.995557e-3, 0.000000)
  , vec3(4.831848e-3, 1.849316e-3, 0.000000)
  , vec3(4.477579e-3, 1.713976e-3, 0.000000)
  , vec3(4.150166e-3, 1.588899e-3, 0.000000)
  , vec3(3.847988e-3, 1.473453e-3, 0.000000)
  , vec3(3.569452e-3, 1.367022e-3, 0.000000)
  , vec3(3.312857e-3, 1.268954e-3, 0.000000)
  , vec3(3.076022e-3, 1.178421e-3, 0.000000)
  , vec3(2.856894e-3, 1.094644e-3, 0.000000)
  , vec3(2.653681e-3, 1.016943e-3, 0.000000)
  , vec3(2.464821e-3, 9.447269e-4, 0.000000)
  , vec3(2.289060e-3, 8.775171e-4, 0.000000)
  , vec3(2.125694e-3, 8.150438e-4, 0.000000)
  , vec3(1.974121e-3, 7.570755e-4, 0.000000)
  , vec3(1.833723e-3, 7.033755e-4, 0.000000)
  , vec3(1.703876e-3, 6.537050e-4, 0.000000)
  , vec3(1.583904e-3, 6.078048e-4, 0.000000)
  , vec3(1.472939e-3, 5.653435e-4, 0.000000)
  , vec3(1.370151e-3, 5.260046e-4, 0.000000)
  , vec3(1.274803e-3, 4.895061e-4, 0.000000)
  , vec3(1.186238e-3, 4.555970e-4, 0.000000)
  , vec3(1.103871e-3, 4.240548e-4, 0.000000)
  , vec3(1.027194e-3, 3.946860e-4, 0.000000)
  , vec3(9.557493e-4, 3.673178e-4, 0.000000)
  , vec3(8.891262e-4, 3.417941e-4, 0.000000)
  , vec3(8.269535e-4, 3.179738e-4, 0.000000)
  , vec3(7.689351e-4, 2.957441e-4, 0.000000)
  , vec3(7.149425e-4, 2.750558e-4, 0.000000)
  , vec3(6.648590e-4, 2.558640e-4, 0.000000)
  , vec3(6.185421e-4, 2.381142e-4, 0.000000)
  , vec3(5.758303e-4, 2.217445e-4, 0.000000)
  , vec3(5.365046e-4, 2.066711e-4, 0.000000)
  , vec3(5.001842e-4, 1.927474e-4, 0.000000)
  , vec3(4.665005e-4, 1.798315e-4, 0.000000)
  , vec3(4.351386e-4, 1.678023e-4, 0.000000)
  , vec3(4.058303e-4, 1.565566e-4, 0.000000)
  , vec3(3.783733e-4, 1.460168e-4, 0.000000)
  , vec3(3.526892e-4, 1.361535e-4, 0.000000)
  , vec3(3.287199e-4, 1.269451e-4, 0.000000)
  , vec3(3.063998e-4, 1.183671e-4, 0.000000)
  , vec3(2.856577e-4, 1.103928e-4, 0.000000)
  , vec3(2.664108e-4, 1.029908e-4, 0.000000)
  , vec3(2.485462e-4, 9.611836e-5, 0.000000)
  , vec3(2.319529e-4, 8.973323e-5, 0.000000)
  , vec3(2.165300e-4, 8.379694e-5, 0.000000)
  , vec3(2.021853e-4, 7.827442e-5, 0.000000)
  , vec3(1.888338e-4, 7.313312e-5, 0.000000)
  , vec3(1.763935e-4, 6.834142e-5, 0.000000)
  , vec3(1.647895e-4, 6.387035e-5, 0.000000)
  , vec3(1.539542e-4, 5.969389e-5, 0.000000)
  , vec3(1.438270e-4, 5.578862e-5, 0.000000)
  , vec3(1.343572e-4, 5.213509e-5, 0.000000)
  , vec3(1.255141e-4, 4.872179e-5, 0.000000)
  , vec3(1.172706e-4, 4.553845e-5, 0.000000)
  , vec3(1.095983e-4, 4.257443e-5, 0.000000)
  , vec3(1.024685e-4, 3.981884e-5, 0.000000)
  , vec3(9.584715e-5, 3.725877e-5, 0.000000)
  , vec3(8.968316e-5, 3.487467e-5, 0.000000)
  , vec3(8.392734e-5, 3.264765e-5, 0.000000)
  , vec3(7.853708e-5, 3.056140e-5, 0.000000)
  , vec3(7.347551e-5, 2.860175e-5, 0.000000)
  , vec3(6.871576e-5, 2.675841e-5, 0.000000)
  , vec3(6.425257e-5, 2.502943e-5, 0.000000)
  , vec3(6.008292e-5, 2.341373e-5, 0.000000)
  , vec3(5.620098e-5, 2.190914e-5, 0.000000)
  , vec3(5.259870e-5, 2.051259e-5, 0.000000)
  , vec3(4.926279e-5, 1.921902e-5, 0.000000)
  , vec3(4.616623e-5, 1.801796e-5, 0.000000)
  , vec3(4.328212e-5, 1.689899e-5, 0.000000)
  , vec3(4.058715e-5, 1.585309e-5, 0.000000)
  , vec3(3.806114e-5, 1.487243e-5, 0.000000)
  , vec3(3.568818e-5, 1.395085e-5, 0.000000)
  , vec3(3.346023e-5, 1.308528e-5, 0.000000)
  , vec3(3.137090e-5, 1.227327e-5, 0.000000)
  , vec3(2.941371e-5, 1.151233e-5, 0.000000)
  , vec3(2.758222e-5, 1.080001e-5, 0.000000)
  , vec3(2.586951e-5, 1.013364e-5, 0.000000)
  , vec3(2.426701e-5, 9.509919e-6, 0.000000)
  , vec3(2.276639e-5, 8.925630e-6, 0.000000)
  , vec3(2.136009e-5, 8.377852e-6, 0.000000)
  , vec3(2.004122e-5, 7.863920e-6, 0.000000)
  , vec3(1.880380e-5, 7.381539e-6, 0.000000)
  , vec3(1.764358e-5, 6.929096e-6, 0.000000)
  , vec3(1.655671e-5, 6.505136e-6, 0.000000)
  , vec3(1.553939e-5, 6.108221e-6, 0.000000)
  , vec3(1.458792e-5, 5.736935e-6, 0.000000)
  , vec3(1.369853e-5, 5.389831e-6, 0.000000)
  , vec3(1.286705e-5, 5.065269e-6, 0.000000)
  , vec3(1.208947e-5, 4.761667e-6, 0.000000)
  , vec3(1.136207e-5, 4.477561e-6, 0.000000)
  , vec3(1.068141e-5, 4.211597e-6, 0.000000)
  , vec3(1.004411e-5, 3.962457e-6, 0.000000)
  , vec3(9.446399e-6, 3.728674e-6, 0.000000)
  , vec3(8.884754e-6, 3.508881e-6, 0.000000)
  , vec3(8.356050e-6, 3.301868e-6, 0.000000)
  , vec3(7.857521e-6, 3.106561e-6, 0.000000)
  , vec3(7.386996e-6, 2.922119e-6, 0.000000)
  , vec3(6.943576e-6, 2.748208e-6, 0.000000)
  , vec3(6.526548e-6, 2.584560e-6, 0.000000)
  , vec3(6.135087e-6, 2.430867e-6, 0.000000)
  , vec3(5.768284e-6, 2.286786e-6, 0.000000)
  , vec3(5.425069e-6, 2.151905e-6, 0.000000)
  , vec3(5.103974e-6, 2.025656e-6, 0.000000)
  , vec3(4.803525e-6, 1.907464e-6, 0.000000)
  , vec3(4.522350e-6, 1.796794e-6, 0.000000)
  , vec3(4.259166e-6, 1.693147e-6, 0.000000)
  , vec3(4.012715e-6, 1.596032e-6, 0.000000)
  , vec3(3.781597e-6, 1.504903e-6, 0.000000)
  , vec3(3.564496e-6, 1.419245e-6, 0.000000)
  , vec3(3.360236e-6, 1.338600e-6, 0.000000)
  , vec3(3.167765e-6, 1.262556e-6, 0.000000)
  , vec3(2.986206e-6, 1.190771e-6, 0.000000)
  , vec3(2.814999e-6, 1.123031e-6, 0.000000)
  , vec3(2.653663e-6, 1.059151e-6, 0.000000)
  , vec3(2.501725e-6, 9.989507e-7, 0.000000)
  , vec3(2.358723e-6, 9.422514e-7, 0.000000)
  , vec3(2.224206e-6, 8.888804e-7, 0.000000)
  , vec3(2.097737e-6, 8.386690e-7, 0.000000)
  , vec3(1.978894e-6, 7.914539e-7, 0.000000)
  , vec3(1.867268e-6, 7.470770e-7, 0.000000)
  , vec3(1.762465e-6, 7.053860e-7, 0.000000)
  );
  float l = wavelength - wavelength_min;
  int i0 = int(floor(l));
  int i1 = i0 + 1;
  float f1 = l - float(i0);
  if (i0 < 0) return vec3(0.0);
  if (i1 > wavelength_count - 1) return vec3(0.0);
  return mix(tristimulus_curve[i0], tristimulus_curve[i1], f1);
#undef wavelength_count
}
